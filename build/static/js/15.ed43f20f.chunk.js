(this.webpackJsonpbbbs_team3_react=this.webpackJsonpbbbs_team3_react||[]).push([[15],{180:function(t,e,n){"use strict";var i=n(2),c=(n(182),n(0));function a(t){var e=t.filterList,n=t.name,a=t.handleClick,r=["tags",t.sectionClass].join(" ").trim(),s=["tags__list",e.length>3?"tags__list_mobile":""].join(" ").trim();return Object(c.jsx)("div",{className:r,children:Object(c.jsx)("ul",{className:s,children:e.map((function(t){return Object(c.jsx)("li",{className:"tags__list-item",children:Object(c.jsx)(i.r,{name:n,value:null===t||void 0===t?void 0:t.filter,title:null===t||void 0===t?void 0:t.name,isActive:null===t||void 0===t?void 0:t.isActive,onClick:a})},null===t||void 0===t?void 0:t.name)}))})})}a.defaultProps={filterList:[],sectionClass:"",name:"",handleClick:function(){}},e.a=a},181:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var i=function(t,e){var n=e.inputValue,i=e.isChecked;t((function(t){return t.map((function(t){return t.filter===n&&(t.isActive=i),t}))}))},c=function(t,e){var n=e.inputValue,i=e.isChecked;t((function(t){return t.map((function(t){return t.filter===n?t.isActive=i:t.isActive=!1,t}))}))},a=function(t,e){t((function(t){return t.map((function(t){return t.filter===e?t.isActive=!0:t.isActive=!1,t}))}))},r=function(t,e){t((function(t){return t.map((function(t){return t.filter===e&&(t.isActive=!1),t}))}))},s=function(t){t((function(t){return t.map((function(t){return t.isActive=!1,t}))}))}},182:function(t,e,n){},206:function(t,e,n){},257:function(t,e,n){"use strict";n.r(e),n.d(e,"PAGE_SIZE_PAGINATE",(function(){return S}));var i=n(5),c=n(1),a=n(16),r=n(3),s={headTitle:"".concat(r.l," | ").concat(r.c),headDescription:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439 \u0434\u043b\u044f \u043d\u0430\u0441\u0442\u0430\u0432\u043d\u0438\u043a\u043e\u0432.",title:r.c,textStubNoData:"\u041c\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c \u043d\u0430\u0434 \u043f\u043b\u0430\u043d\u043e\u043c \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439 \u043d\u0430 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0435 \u043c\u0435\u0441\u044f\u0446\u044b."},o=n(8),u=n(7),l=n(4),f=n(181),j=n(11),d=n(14),b=n.n(d),v=n(6);var h=n(44),m=n(52),O=n(45),g=n(180),p=n(2),x=n(10),E=(n(206),n(0)),_=s.headTitle,C=s.headDescription,k=s.title,A=s.textStubNoData,S={small:6,medium:8,big:12},P=1024,w=1440;e.default=function(){var t=Object(c.useContext)(o.b).currentUser,e=Object(c.useContext)(o.d),n=e.openPopupLogin,r=e.openPopupAboutEvent,s=e.openPopupError,d=Object(c.useContext)(o.c).setError,N=Object(a.h)().state,L=Object(c.useState)(!1),D=Object(i.a)(L,2),F=D[0],T=D[1],M=Object(c.useState)(!1),I=Object(i.a)(M,2),V=I[0],y=I[1],G=Object(c.useState)(!1),J=Object(i.a)(G,2),R=J[0],U=J[1],W=Object(c.useState)(null),q=Object(i.a)(W,2),B=q[0],Z=q[1],z=Object(c.useState)(null),H=Object(i.a)(z,2),K=H[0],Q=H[1],X=Object(c.useState)(!1),Y=Object(i.a)(X,2),$=Y[0],tt=Y[1],et=Object(c.useState)(null),nt=Object(i.a)(et,2),it=nt[0],ct=nt[1],at=Object(c.useState)(null),rt=Object(i.a)(at,2),st=rt[0],ot=rt[1],ut=Object(c.useState)(0),lt=Object(i.a)(ut,2),ft=lt[0],jt=lt[1],dt=Object(c.useState)(!0),bt=Object(i.a)(dt,2),vt=bt[0],ht=bt[1],mt=Object(c.useState)(!1),Ot=Object(i.a)(mt,2),gt=Ot[0],pt=Ot[1];Object(c.useEffect)((function(){var t=window.matchMedia("(max-width: ".concat(P,"px)")),e=window.matchMedia("(max-width: ".concat(w,"px)")),n=function(){t.matches?ct(S.small):e.matches?ct(S.medium):ct(S.big)};return n(),t.addEventListener("change",n),e.addEventListener("change",n),function(){t.removeEventListener("change",n),e.removeEventListener("change",n)}}),[]);var xt=(null===B||void 0===B?void 0:B.length)>0;function Et(){return K?K.filter((function(t){return t.isActive})):[]}function _t(t){var e=t.offset,n=t.activeFilters;(function(t){var e=t.limit,n=t.offset,i=t.months;return b.a.get("".concat(v.b).concat(v.a,"/afisha/events/"),{params:{limit:e,offset:n,months:i}}).then((function(t){return t.data})).catch((function(t){return Promise.reject(new Error("".concat(t.message)))}))})({limit:it,offset:e,months:n}).then((function(t){var e=t.results,n=t.count;ot(Math.ceil(n/it)),Z(e)})).catch((function(){$?(d(l.g.filterErrorMessage),s()):pt(!0)})).finally((function(){T(!1),y(!1),U(!1)}))}function Ct(t,e){Object(f.d)(Q,{inputValue:t,isChecked:e}),tt(!0)}Object(c.useEffect)((function(){var t;N&&(t=N.id,b.a.get("".concat(v.b).concat(v.a,"/afisha/events/").concat(t)).then((function(t){return t.data})).catch((function(t){return Promise.reject(new Error("".concat(t.message)))}))).then((function(t){Object(x.e)(l.k,t),r()})).catch((function(){return pt(!0)}))}),[N]),Object(c.useEffect)((function(){t&&it&&(_t({offset:it*ft}),ht(!1));t||n()}),[it,t]),Object(c.useEffect)((function(){t&&(y(!0),b.a.get("".concat(v.b).concat(v.a,"/afisha/events/months/")).then((function(t){return t.data.months})).catch((function(t){return Promise.reject(new Error("".concat(t.message)))})).then((function(t){var e=t.map((function(t){return{isActive:!1,name:Object(j.a)(l.n[t-1]),filter:t}}));Q(e)})).catch((function(){return pt(!0)})))}),[null===t||void 0===t?void 0:t.city]);var kt=Object(u.f)((function(){var t=Et(),e=$?0:it*ft;if(0===t.length)_t({limit:it,offset:e});else{var n=t[0].filter;_t({limit:it,offset:e,activeFilters:n})}}),l.d);Object(c.useEffect)((function(){$&&(T(!0),kt()),tt(!1)}),[$]);var At=Object(u.f)(_t,l.d);Object(c.useEffect)((function(){if(!vt){var t=Et();if(U(!0),t.length>0){var e=it*ft,n=t[0].filter;At({offset:e,activeFilters:n})}if(0===t.length)At({offset:it*ft})}}),[ft]);var St=Object(u.g)(),Pt=St.handleEventBooking,wt=St.selectedEvent,Nt=St.isWaitingResponse;return Object(c.useEffect)((function(){wt&&Z((function(){return B.map((function(t){return t.id===wt.id?wt:t}))}))}),[wt]),B&&K||gt?Object(E.jsx)(h.a,{headTitle:_,headDescription:C,children:Object(E.jsx)("section",{className:"calendar-page page__section fade-in",children:function(){if(gt)return Object(E.jsx)(O.a,{titleText:l.g.generalErrorMessage.title});if(t&&xt)return Object(E.jsx)(E.Fragment,{children:V?Object(E.jsx)(p.k,{isPaginate:!0}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(p.w,{title:k,sectionClass:"calendar-page__title"}),Object(E.jsxs)("div",{className:"calendar-page__container",children:[(null===K||void 0===K?void 0:K.length)>1&&Object(E.jsx)(g.a,{filterList:K,name:"month",handleClick:Ct}),F?Object(E.jsx)(p.k,{isPaginate:!0}):Object(E.jsxs)(E.Fragment,{children:[R?Object(E.jsx)(p.k,{isPaginate:!0}):Object(E.jsx)("div",{className:"calendar-page__grid",children:B.map((function(t){var e;return Object(E.jsx)(m.a,{cardData:t,onEventSignUpClick:Pt,onEventDescriptionClick:r,sectionClass:"scale-in",isWaitingResponse:Nt,loadingEventId:Nt?null===(e=Object(x.c)(l.k))||void 0===e?void 0:e.id:void 0},t.id)}))}),st>1&&Object(E.jsx)(p.q,{sectionClass:"cards-section__pagination",pageCount:st,value:ft,onChange:jt})]})]})]})});if(t&&!xt&&B)return Object(E.jsx)(E.Fragment,{children:V?Object(E.jsx)(p.k,{isPaginate:!0}):Object(E.jsx)(O.a,{titleText:A})});return null}()})}):Object(E.jsx)(p.k,{isCentered:!0})}}}]);
//# sourceMappingURL=15.ed43f20f.chunk.js.map