{"version":3,"sources":["api/articles-page.js","pages/Articles/locales/RU.js","pages/Articles/Articles.js"],"names":["getArticlesPageData","limit","offset","axios","get","baseURL","apiUrl","params","then","response","data","catch","err","Promise","reject","Error","message","getArticle","id","articlesPageTexts","headTitle","MAIN_PAGE_TITLE","ARTICLES_TITLE","headDescription","title","textStubNoData","PAGE_SIZE_PAGINATE","maxScreenWidth","Articles","useState","pageSize","setPageSize","pageCount","setPageCount","pageNumber","setPageNumber","articlesPageData","setArticlesPageData","mainArticle","setMainCard","isLoadingPage","setIsLoadingPage","isLoadingPaginate","setIsLoadingPaginate","isPageError","setIsPageError","isArticlePopupOpen","setIsArticlePopupOpen","state","useLocation","searchArticleId","searchedArticle","setSearchedArticle","useEffect","article","fixedPageSize","fixedOffset","results","filter","item","pinnedFullSize","finally","getPageData","count","articlesData","mainCard","find","Math","ceil","pop","smallQuery","window","matchMedia","listener","matches","addEventListener","removeEventListener","isCentered","BasePage","AnimatedPageContainer","titleText","ERROR_MESSAGES","generalErrorMessage","className","sectionClass","isPaginate","CardArticle","isMain","map","i","color","COLORS","length","renderPagination","renderPageContent","renderAnimatedContainer","isOpen","onClose","value","onChange"],"mappings":"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","file":"static/js/17.2b3ac0a2.chunk.js","sourcesContent":["import axios from 'axios';\nimport { apiUrl, baseURL } from '../config/config';\n\nfunction getArticlesPageData({ limit, offset }) {\n  return axios\n    .get(`${baseURL}${apiUrl}/articles/`, {\n      params: { limit, offset },\n    })\n    .then((response) => response.data)\n    .catch((err) => Promise.reject(new Error(`${err.message}`)));\n}\n\n// получение одного книги\nfunction getArticle(id) {\n  return axios\n    .get(`${baseURL}${apiUrl}/articles/${id}`)\n    .then((response) => response.data)\n    .catch((err) => Promise.reject(new Error(`${err.message}`)));\n}\n\nexport { getArticlesPageData, getArticle };\n","import { ARTICLES_TITLE, MAIN_PAGE_TITLE } from '../../../config/routes';\n\nconst articlesPageTexts = {\n  headTitle: `${MAIN_PAGE_TITLE} | ${ARTICLES_TITLE}`,\n  headDescription: 'Статьи, которые рекомендуют наши наставники.',\n  title: ARTICLES_TITLE,\n  textStubNoData: 'Информация появится в ближайшее время.',\n};\n\nexport default articlesPageTexts;\n","import { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport articlesPageTexts from './locales/RU';\nimport { COLORS, ERROR_MESSAGES } from '../../config/constants';\nimport {\n  AnimatedPageContainer,\n  BasePage,\n  CardArticle,\n  Loader,\n  Paginate,\n  PopupArticle,\n  TitleH1,\n} from './index';\nimport { getArticle, getArticlesPageData } from '../../api/articles-page';\nimport './Articles.scss';\n\nconst PAGE_SIZE_PAGINATE = {\n  small: 8,\n  big: 12,\n};\n\nconst maxScreenWidth = {\n  small: 1024,\n};\n\nconst { headTitle, headDescription, title, textStubNoData } = articlesPageTexts;\n\nfunction Articles() {\n  const [pageSize, setPageSize] = useState(null);\n  const [pageCount, setPageCount] = useState(0);\n  const [pageNumber, setPageNumber] = useState(0);\n\n  const [articlesPageData, setArticlesPageData] = useState(null);\n  const [mainArticle, setMainCard] = useState(null);\n  const [isLoadingPage, setIsLoadingPage] = useState(true);\n  const [isLoadingPaginate, setIsLoadingPaginate] = useState(false);\n  const [isPageError, setIsPageError] = useState(false);\n  const [isArticlePopupOpen, setIsArticlePopupOpen] = useState(false);\n\n  const { state } = useLocation();\n  const searchArticleId = state?.id;\n  const [searchedArticle, setSearchedArticle] = useState({});\n\n  const getPageData = () => {\n    const offset = pageSize * pageNumber;\n    const fixedPageSize =\n      pageNumber === 0 && mainArticle ? pageSize + 1 : pageSize;\n    const fixedOffset = pageNumber > 0 && mainArticle ? offset + 1 : offset;\n\n    getArticlesPageData({ limit: fixedPageSize, offset: fixedOffset })\n      .then(({ results }) => {\n        if (pageNumber === 0 && mainArticle) {\n          setArticlesPageData(() =>\n            results.filter((item) => !item?.pinnedFullSize)\n          );\n        } else setArticlesPageData(results);\n      })\n      .catch(() => setIsPageError(true))\n      .finally(() => {\n        setIsLoadingPaginate(false);\n      });\n  };\n\n  const openPopupArticle = () => {\n    setIsArticlePopupOpen(true);\n  };\n\n  const closePopupArticle = () => {\n    setIsArticlePopupOpen(false);\n  };\n\n  // Открытие попапа при переходе из поиска\n  useEffect(() => {\n    if (state) {\n      getArticle(searchArticleId)\n        .then((article) => {\n          setSearchedArticle(article);\n          openPopupArticle();\n        })\n        .catch(() => setIsPageError(true));\n    }\n  }, [state]);\n\n  // пагинация\n  useEffect(() => {\n    if (!isLoadingPage) {\n      setIsLoadingPaginate(true);\n      getPageData();\n    }\n  }, [pageNumber]);\n\n  useEffect(() => {\n    if (pageSize) {\n      getArticlesPageData({ limit: pageSize + 1 })\n        .then(({ results, count }) => {\n          const articlesData = results;\n          const mainCard = articlesData.find((item) => item?.pinnedFullSize);\n          setMainCard(mainCard);\n          if (mainCard) {\n            setArticlesPageData(() =>\n              articlesData.filter((item) => !item?.pinnedFullSize)\n            );\n            setPageCount(Math.ceil((count - 1) / pageSize));\n          } else {\n            articlesData.pop();\n            setArticlesPageData(articlesData);\n            setPageCount(Math.ceil(count / pageSize));\n          }\n        })\n        .catch(() => {\n          setIsPageError(true);\n        })\n        .finally(() => {\n          setIsLoadingPage(false);\n        });\n    }\n  }, [pageSize]);\n\n  useEffect(() => {\n    const smallQuery = window.matchMedia(\n      `(max-width: ${maxScreenWidth.small}px)`\n    );\n\n    const listener = () => {\n      if (smallQuery.matches) {\n        setPageSize(PAGE_SIZE_PAGINATE.small);\n      } else {\n        setPageSize(PAGE_SIZE_PAGINATE.big);\n      }\n    };\n    listener();\n\n    smallQuery.addEventListener('change', listener);\n\n    return () => {\n      smallQuery.removeEventListener('change', listener);\n    };\n  }, []);\n\n  if (isLoadingPage) {\n    return <Loader isCentered />;\n  }\n\n  return (\n    <>\n      <BasePage headTitle={headTitle} headDescription={headDescription}>\n        {!articlesPageData && !isLoadingPage\n          ? renderAnimatedContainer()\n          : renderPageContent()}\n      </BasePage>\n      <PopupArticle\n        isOpen={isArticlePopupOpen}\n        onClose={closePopupArticle}\n        article={searchedArticle}\n      />\n    </>\n  );\n\n  function renderPageContent() {\n    if (isPageError) {\n      return (\n        <AnimatedPageContainer\n          titleText={ERROR_MESSAGES.generalErrorMessage.title}\n        />\n      );\n    }\n\n    return (\n      <section className=\"articles page__section\">\n        <TitleH1 title={title} sectionClass=\"fade-in\" />\n\n        {isLoadingPaginate ? <Loader isPaginate /> : renderCards()}\n\n        {renderPagination()}\n      </section>\n    );\n  }\n\n  function renderAnimatedContainer() {\n    if (isPageError) {\n      return (\n        <AnimatedPageContainer\n          titleText={ERROR_MESSAGES.generalErrorMessage.title}\n        />\n      );\n    }\n    return <AnimatedPageContainer titleText={textStubNoData} />;\n  }\n\n  function renderPagination() {\n    if (pageCount > 1) {\n      return (\n        <Paginate\n          sectionClass=\"cards-section__pagination\"\n          pageCount={pageCount}\n          value={pageNumber}\n          onChange={setPageNumber}\n        />\n      );\n    }\n    return null;\n  }\n\n  function renderCards() {\n    return (\n      <>\n        {mainArticle && !pageNumber && (\n          <section className=\"articles__main scale-in\">\n            <CardArticle data={mainArticle} isMain />\n          </section>\n        )}\n\n        <section className=\"articles__cards-grid\">\n          {articlesPageData.map((item, i) => (\n            <CardArticle\n              key={item?.id}\n              color={COLORS[(i + 1) % COLORS.length]}\n              data={item}\n              sectionClass=\"scale-in\"\n            />\n          ))}\n        </section>\n      </>\n    );\n  }\n}\n\nexport default Articles;\n"],"sourceRoot":""}