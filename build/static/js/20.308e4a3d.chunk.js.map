{"version":3,"sources":["utils/filter-tags.js","pages/Stories/locales/RU.js","pages/Stories/Stories.js","api/stories-page.js"],"names":["handleCheckboxBehavior","setState","inputValue","isChecked","stateFilters","map","filterItem","filter","isActive","handleRadioBehavior","selectOneTag","tagName","deselectOneTag","deselectAllTags","storiesPageTexts","headTitle","MAIN_PAGE_TITLE","headDescription","title","subtitle","textStubNoData","carouselItemPaddings","maxScreenWidth","Stories","storyId","useParams","history","useHistory","currentUser","useContext","CurrentUserContext","useState","isPageLoading","setIsPageLoading","isStoryLoading","setIsStoryLoading","isPageError","setIsPageError","storiesTags","setStoriesTags","tagsOffset","setTagsOffset","currentStory","setCurrentStory","isPopupPhotoOpen","setIsPopupPhotoOpen","currentPhoto","setCurrentPhoto","currentStoryId","mentorName","mentor","firstName","childName","child","pairTitle","togetherSinceDate","formatDate","togetherSince","togetherSinceText","formatMonthsGenitiveCase","monthName","year","emailText","inclineFirstname","nextArticleLink","STORIES_URL","nextArticle","id","photoCarouselRef","useRef","carouselItemPadding","setCarouselItemPaddings","openFullPhoto","imageSrc","caption","photoSrc","handleFilters","push","fetchTags","limit","offset","length","axios","get","baseURL","apiUrl","params","then","response","data","catch","err","Promise","reject","Error","message","getStoriesPageTags","results","storiesTagsData","tag","name","pair","prevTags","prevOffset","fetchTagsOnNextLink","useEffect","tablet","window","matchMedia","mobile","listenWindowWidth","matches","addEventListener","removeEventListener","status","ERROR_CODES","notFound","NOT_FOUND_URL","finally","tagToBeActive","find","scrollAnchorRef","current","setTimeout","scrollIntoView","behavior","isCentered","BasePage","AnimatedPageContainer","titleText","ERROR_MESSAGES","generalErrorMessage","className","sectionClass","ref","step","useButtons","disableMouseDrag","onScrollCallback","prevButtonClass","nextButtonClass","item","value","onClick","isPaginate","src","staticImageUrl","image","alt","description","uperBody","renderPhotosCarousel","lowerBody","renderLinksBlock","renderPageContent","isOpen","onClose","email","href","target","rel","text","itemsToScroll","itemsToShow","initialActiveIndex","itemPadding","pagination","enableMouseSwipe","aria-hidden","images","idx","goTo","imageCaption","onKeyPress","role","tabIndex","draggable"],"mappings":"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","file":"static/js/20.308e4a3d.chunk.js","sourcesContent":["/* eslint-disable no-param-reassign */\nexport const handleCheckboxBehavior = (setState, { inputValue, isChecked }) => {\n  setState((stateFilters) =>\n    stateFilters.map((filterItem) => {\n      if (filterItem.filter === inputValue) {\n        filterItem.isActive = isChecked;\n      }\n      return filterItem;\n    })\n  );\n};\n\nexport const handleRadioBehavior = (setState, { inputValue, isChecked }) => {\n  setState((stateFilters) =>\n    stateFilters.map((filterItem) => {\n      if (filterItem.filter === inputValue) {\n        filterItem.isActive = isChecked;\n      } else {\n        filterItem.isActive = false;\n      }\n      return filterItem;\n    })\n  );\n};\n\nexport const selectOneTag = (setState, tagName) => {\n  setState((stateFilters) =>\n    stateFilters.map((filterItem) => {\n      if (filterItem.filter === tagName) {\n        filterItem.isActive = true;\n      } else {\n        filterItem.isActive = false;\n      }\n      return filterItem;\n    })\n  );\n};\n\nexport const deselectOneTag = (setState, tagName) => {\n  setState((stateFilters) =>\n    stateFilters.map((filterItem) => {\n      if (filterItem.filter === tagName) {\n        filterItem.isActive = false;\n      }\n      return filterItem;\n    })\n  );\n};\n\nexport const deselectAllTags = (setState) => {\n  setState((stateFilters) =>\n    stateFilters.map((filterItem) => {\n      filterItem.isActive = false;\n      return filterItem;\n    })\n  );\n};\n","import { MAIN_PAGE_TITLE } from '../../../config/routes';\n\nconst storiesPageTexts = {\n  headTitle: `${MAIN_PAGE_TITLE} | Истории дружбы`,\n  headDescription: 'Истории дружбы с младшими от наших наставников',\n  title: 'Истории дружбы',\n  subtitle:\n    'Результат нашей работы сложно показать цифрами. Как измерить и взвесить дружбу? Как оценить успехи абсолютно разных детей? У каждой пары — свой результат и свои достижения. Именно об этом мы рассказываем в историях.',\n  textStubNoData:\n    'В данный момент страница со историями дружбы пуста. Возвращайтесь позже!',\n};\n\nexport default storiesPageTexts;\n","import { useContext, useEffect, useRef, useState } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport Carousel from 'react-elastic-carousel';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { inclineFirstname } from 'lvovich';\nimport storiesPageTexts from './locales/RU';\nimport { ERROR_CODES, ERROR_MESSAGES } from '../../config/constants';\nimport { CurrentUserContext } from '../../contexts';\nimport { staticImageUrl } from '../../config/config';\nimport { NOT_FOUND_URL, STORIES_URL } from '../../config/routes';\nimport { getStoriesPageTags, getStoryById } from '../../api/stories-page';\nimport { formatDate, formatMonthsGenitiveCase } from '../../utils/utils';\nimport { handleRadioBehavior } from '../../utils/filter-tags';\nimport {\n  AnimatedPageContainer,\n  BasePage,\n  Caption,\n  Loader,\n  NextArticleLink,\n  PopupPhoto,\n  PseudoButtonTag,\n  ScrollableContainer,\n  TitleH1,\n  TitleH2,\n} from './index';\nimport './Stories.scss';\n\nconst carouselItemPaddings = {\n  desktop: [0, 65],\n  tablet: [0, 15],\n  mobile: [0, 7.5],\n};\n\nconst maxScreenWidth = {\n  small: 706,\n  medium: 1100,\n};\n\nconst tagsLimit = 10;\nconst scrollUpDelay = 150;\n\nconst { headTitle, headDescription, title, subtitle, textStubNoData } =\n  storiesPageTexts;\n\nfunction Stories() {\n  const { storyId } = useParams();\n  const history = useHistory();\n  const { currentUser } = useContext(CurrentUserContext);\n\n  const [isPageLoading, setIsPageLoading] = useState(true);\n  const [isStoryLoading, setIsStoryLoading] = useState(false);\n  const [isPageError, setIsPageError] = useState(false);\n\n  const [storiesTags, setStoriesTags] = useState([]);\n  const [tagsOffset, setTagsOffset] = useState(0);\n\n  const [currentStory, setCurrentStory] = useState(null);\n  const [isPopupPhotoOpen, setIsPopupPhotoOpen] = useState(false);\n  const [currentPhoto, setCurrentPhoto] = useState({});\n\n  const openPhotoPopup = () => {\n    setIsPopupPhotoOpen(true);\n  };\n\n  const closePhotoPopup = () => {\n    setIsPopupPhotoOpen(false);\n  };\n\n  const currentStoryId = +(storyId ?? storiesTags[0]?.filter);\n  const mentorName = currentStory?.mentor?.firstName ?? '';\n  const childName = currentStory?.child ?? '';\n  const pairTitle = `${mentorName} и ${childName}`;\n\n  const togetherSinceDate = formatDate(currentStory?.togetherSince);\n  const togetherSinceText = `Вместе с ${formatMonthsGenitiveCase(\n    togetherSinceDate?.monthName\n  )} ${togetherSinceDate?.year} года`;\n\n  const emailText = `написать ${inclineFirstname(mentorName, 'dative')}`;\n  const nextArticleLink = `${STORIES_URL}/${currentStory?.nextArticle?.id}`;\n\n  const photoCarouselRef = useRef(null);\n  const [carouselItemPadding, setCarouselItemPaddings] = useState(\n    carouselItemPaddings.desktop\n  );\n\n  const openFullPhoto = (imageSrc, caption) => {\n    setCurrentPhoto({\n      photoSrc: imageSrc,\n      caption,\n    });\n    openPhotoPopup();\n  };\n\n  const handleFilters = (inputValue) => {\n    handleRadioBehavior(setStoriesTags, { inputValue, isChecked: true });\n    history.push(`${STORIES_URL}/${inputValue}`);\n  };\n\n  const fetchTags = ({ limit, offset }) => {\n    if (tagsOffset <= storiesTags.length) {\n      getStoriesPageTags({ limit, offset })\n        .then(({ results }) => {\n          if (results?.length) {\n            const storiesTagsData = results.map((tag) => ({\n              filter: tag.id,\n              name: tag.pair,\n              isActive: +storyId === +tag.id,\n            }));\n            setStoriesTags((prevTags) => [...prevTags, ...storiesTagsData]);\n            setTagsOffset((prevOffset) => prevOffset + limit);\n          } else {\n            setIsPageLoading(false);\n          }\n        })\n        .catch(() => {\n          setIsPageError(true);\n          setIsPageLoading(false);\n        });\n    }\n  };\n\n  // подгрузка тегов при переключении по ссылкам внизу\n  const fetchTagsOnNextLink = () => {\n    if (currentStoryId === storiesTags[storiesTags.length - 1].filter) {\n      fetchTags({ limit: tagsLimit, offset: tagsOffset });\n    }\n  };\n\n  // динамические падинги для фото слайдера\n  useEffect(() => {\n    const tablet = window.matchMedia(`(max-width: ${maxScreenWidth.medium}px)`);\n    const mobile = window.matchMedia(`(max-width: ${maxScreenWidth.small}px)`);\n\n    const listenWindowWidth = () => {\n      if (mobile.matches)\n        return setCarouselItemPaddings(carouselItemPaddings.mobile);\n\n      if (tablet.matches)\n        return setCarouselItemPaddings(carouselItemPaddings.tablet);\n\n      return setCarouselItemPaddings(carouselItemPaddings.desktop);\n    };\n    listenWindowWidth();\n\n    mobile.addEventListener('change', listenWindowWidth);\n    tablet.addEventListener('change', listenWindowWidth);\n\n    return () => {\n      mobile.removeEventListener('change', listenWindowWidth);\n      tablet.removeEventListener('change', listenWindowWidth);\n    };\n  }, []);\n\n  // получение списка всех историй\n  useEffect(() => {\n    fetchTags({ limit: tagsLimit, offset: tagsOffset });\n  }, []);\n\n  // получение конкретной истории по id\n  useEffect(() => {\n    if (currentStoryId) {\n      setIsStoryLoading(true);\n      getStoryById(currentStoryId)\n        .then(setCurrentStory)\n        .catch((err) => {\n          if (err.status === ERROR_CODES.notFound) history.push(NOT_FOUND_URL);\n          else setIsPageError(true);\n        })\n        .finally(() => {\n          setIsStoryLoading(false);\n          if (isPageLoading) setIsPageLoading(false);\n        });\n    }\n  }, [currentStoryId]);\n\n  // синхронизация фильтров в зависимости от выбранной истории\n  useEffect(() => {\n    if (storiesTags.length) {\n      const tagToBeActive = storiesTags.find(\n        (tag) => tag.filter === currentStoryId\n      );\n      if (tagToBeActive) {\n        handleRadioBehavior(setStoriesTags, {\n          inputValue: tagToBeActive.filter,\n          isChecked: true,\n        });\n      }\n    }\n  }, [currentStoryId, tagsOffset]);\n\n  // прокрутка наверх при переключении историй\n  const scrollAnchorRef = useRef(null);\n\n  useEffect(() => {\n    if (scrollAnchorRef && scrollAnchorRef.current) {\n      setTimeout(() => {\n        scrollAnchorRef.current.scrollIntoView({ behavior: 'smooth' });\n      }, scrollUpDelay);\n    }\n  }, [storyId]);\n\n  if (isPageLoading) {\n    return <Loader isCentered />;\n  }\n\n  return (\n    <>\n      <BasePage headTitle={headTitle} headDescription={headDescription}>\n        {renderPageContent()}\n      </BasePage>\n      <PopupPhoto\n        isOpen={isPopupPhotoOpen}\n        onClose={closePhotoPopup}\n        currentPhoto={currentPhoto}\n      />\n    </>\n  );\n\n  // функции рендера\n  function renderPageContent() {\n    if (isPageError) {\n      return (\n        <AnimatedPageContainer\n          titleText={ERROR_MESSAGES.generalErrorMessage.title}\n        />\n      );\n    }\n\n    if (!storiesTags.length && !currentStory) {\n      return <AnimatedPageContainer titleText={textStubNoData} />;\n    }\n\n    return (\n      <div className=\"stories page__section fade-in\">\n        <TitleH1 title={title} sectionClass=\"stories__title\" />\n        <p className=\"stories__subtitle\">{subtitle}</p>\n\n        {renderTags()}\n\n        {isStoryLoading ? (\n          <Loader isPaginate />\n        ) : (\n          <>\n            {renderUpperBlock()}\n\n            <ReactMarkdown className=\"markdown stories__markdown fade-in\">\n              {currentStory?.uperBody}\n            </ReactMarkdown>\n\n            {renderPhotosCarousel()}\n\n            <ReactMarkdown className=\"markdown stories__markdown stories__markdown_last fade-in\">\n              {currentStory?.lowerBody}\n            </ReactMarkdown>\n\n            {renderLinksBlock()}\n          </>\n        )}\n      </div>\n    );\n  }\n\n  function renderUpperBlock() {\n    return (\n      <>\n        <img\n          className=\"stories__main-photo scale-in\"\n          src={`${staticImageUrl}/${currentStory?.image}`}\n          alt={pairTitle}\n        />\n        <TitleH2 title={pairTitle} sectionClass=\"stories__pair-title fade-in\" />\n        <Caption\n          title={togetherSinceText}\n          sectionClass=\"stories__caption fade-in\"\n        />\n        <p className=\"stories__subtitle stories__subtitle_last fade-in\">\n          {currentStory?.description}\n        </p>\n      </>\n    );\n  }\n\n  function renderLinksBlock() {\n    return (\n      <div className=\"stories__links fade-in\">\n        {currentUser && currentStory?.mentor?.email && (\n          <a\n            className=\"link stories__link\"\n            href={`mailto:${currentStory.mentor.email}`}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            {emailText}\n          </a>\n        )}\n\n        {currentStory?.nextArticle && (\n          <NextArticleLink\n            text={currentStory.nextArticle.title}\n            href={nextArticleLink}\n            onClick={fetchTagsOnNextLink}\n            sectionClass=\"stories__link_next\"\n          />\n        )}\n      </div>\n    );\n  }\n\n  function renderTags() {\n    return (\n      <div className=\"stories__tags-carousel fade-in\">\n        <span className=\"stories__scroll-anchor\" ref={scrollAnchorRef} />\n        <ScrollableContainer\n          step={5}\n          useButtons\n          disableMouseDrag\n          onScrollCallback={() =>\n            fetchTags({ limit: tagsLimit, offset: tagsOffset })\n          }\n          sectionClass=\"stories__scroll-container\"\n          prevButtonClass=\"stories__prev-button\"\n          nextButtonClass=\"stories__next-button\"\n        >\n          {storiesTags.map((item) => (\n            <PseudoButtonTag\n              key={item.filter}\n              name={item.name}\n              value={item.filter}\n              title={item.name}\n              isActive={item.isActive}\n              onClick={handleFilters}\n              sectionClass=\"scrollable-container__child\"\n            />\n          ))}\n        </ScrollableContainer>\n      </div>\n    );\n  }\n\n  function renderPhotosCarousel() {\n    return (\n      <div className=\"stories__photo-carousel-container\">\n        <div className=\"stories__photo-carousel-wrapper\">\n          <Carousel\n            ref={photoCarouselRef}\n            className=\"stories__photo-carousel\"\n            itemsToScroll={1}\n            itemsToShow={3}\n            initialActiveIndex={0}\n            itemPadding={carouselItemPadding}\n            pagination={false}\n            enableMouseSwipe={false}\n          >\n            <div aria-hidden className=\"stories__carousel-image\" />\n            {currentStory?.images?.map((image, idx) => (\n              <div\n                key={image.id}\n                className=\"stories__carousel-image-wrap\"\n                onClick={() => {\n                  photoCarouselRef.current.goTo(idx);\n                  openFullPhoto(\n                    `${staticImageUrl}/${image.image}`,\n                    image.imageCaption\n                  );\n                }}\n                onKeyPress={() => {\n                  photoCarouselRef.current.goTo(idx);\n                  openFullPhoto(\n                    `${staticImageUrl}/${image.image}`,\n                    image.imageCaption\n                  );\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                <img\n                  className=\"stories__carousel-image\"\n                  draggable={false}\n                  src={`${staticImageUrl}/${image.image}`}\n                  alt={image.imageCaption}\n                />\n              </div>\n            ))}\n            <div aria-hidden className=\"stories__carousel-image\" />\n          </Carousel>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Stories;\n","import axios from 'axios';\nimport { apiUrl, baseURL } from '../config/config';\n\n// получение списка историй (список фильтров)\nfunction getStoriesPageTags({ limit, offset }) {\n  return axios\n    .get(`${baseURL}${apiUrl}/history/`, {\n      params: { limit, offset },\n    })\n    .then((response) => response.data)\n    .catch((err) => Promise.reject(new Error(`${err.message}`)));\n}\n\nfunction getStoryById(id) {\n  return axios\n    .get(`${baseURL}${apiUrl}/history/${id}/`)\n    .then((response) => response.data)\n    .catch((err) => Promise.reject(err?.response));\n}\n\nexport { getStoriesPageTags, getStoryById };\n"],"sourceRoot":""}